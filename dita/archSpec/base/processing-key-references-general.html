---
# Generated from DITA source
layout: base
title: 'Processing key references'
description: 'Key references can resolve as links, as text, or as both. Within a map, they also can be used to create or supplement information on a topic reference. This topic covers information that is common to all key processing, regardless of how the key is used.'
index: '../../toc.html'
notices: '../../resources/oasis-notices.html'
commit: 'adaf2c7cf4d9c09d789de4e79b975464ce855129'
repository: 'oasis-tcs/dita'
---

<nav role="toc" class="col-lg-3"><ul><li><a href="../../introduction/dita-release-overview.html">Introduction</a></li><li><a href="../../archSpec/base/dita-terminology.html">DITA terminology, notation, and conventions</a></li><li><a href="../../archSpec/base/introduction-to-dita.html">Overview of DITA</a></li><li><a href="../../archSpec/base/accessibility-and-translation.html">Accessibility and translation</a></li><li><a href="../../archSpec/base/dita-map-processing.html">DITA map processing</a></li><li><a href="../../archSpec/base/ditaaddressing.html">DITA addressing</a><ul class="nav nav-list"><li><a href="../../archSpec/base/id.html">id attribute</a></li><li><a href="../../archSpec/base/dita-linking.html">DITA linking</a></li><li><a href="../../archSpec/base/uri-based-addressing.html">URI-based (direct) addressing</a></li><li><a href="../../archSpec/base/key-based-addressing.html">Indirect key-based addressing</a><ul class="nav nav-list"><li><a href="../../archSpec/base/keys-core-concepts.html">Core concepts for working with keys</a></li><li><a href="../../archSpec/base/thekeysattribute.html">Setting key names with the keys attribute</a></li><li><a href="../../archSpec/base/thekeyrefattribute.html">The keyref attribute</a></li><li><a href="../../archSpec/base/using-keys-for-addressing.html">Using keys for addressing</a></li><li><a href="../../archSpec/base/keyScopes.html">Key scopes</a></li><li><a href="../../archSpec/base/the-key-scope-attribute.html">The keyscope attribute</a></li><li><a href="../../archSpec/base/using-keys-to-address-keys-across-scopes.html">Addressing keys across scopes</a></li><li><a href="../../archSpec/base/links-between-maps.html">Cross-deliverable addressing and linking</a></li><li class="active"><a href="../../archSpec/base/processing-key-references-general.html">Processing key references</a></li><li><a href="../../archSpec/base/processing-keyref-for-links.html">Processing key references for navigation links and images</a></li><li><a href="../../archSpec/base/processing-keyref-on-topicref.html">Processing key references on topicref elements</a></li><li><a href="../../archSpec/base/processing-keyref-for-text.html">Processing key references to generate text or link text</a></li><li><a href="../../archSpec/base/examples-of-keys.html">Examples of keys</a></li><li><a href="../../archSpec/base/examples-of-scoped-keys.html">Examples of scoped keys</a></li></ul></li><li><a href="../../archSpec/base/context-hooks-for-user-assistance.html">Context hooks for user assistance</a></li></ul></li><li><a href="../../archSpec/base/behaviors.html">DITA processing</a></li><li><a href="../../archSpec/base/configuration-specialization-and-constraints.html">Configuration and specialization </a></li><li><a href="../../langRef/langRef-base.html">Element reference</a></li><li><a href="../../conformance/conformance.html">Conformance</a></li><li><a href="../../acknowledgments/acknowledgments.html">Acknowledgments</a></li><li><a href="../../non-normative/aggregated-RFC-2119-statements.html">Aggregated RFC-2119 statements</a></li><li><a href="../../archSpec/base/coding-requirements.html">Coding practices for DITA grammar files</a></li><li><a href="../../non-normative/developing-constraint-and-expansion-modules.html">Constraint modules</a></li><li><a href="../../non-normative/expansion-modules.html">Expansion modules</a></li><li><a href="../../non-normative/elementsMerged.html">Element-by-element recommendations for translators</a></li><li><a href="../../non-normative/formatting-expectations.html">Formatting expectations</a></li><li><a href="../../non-normative/migrating-to-dita-2.0.html">Migrating to DITA 2.0</a></li><li><a href="../../non-normative/basedoctypes.html">OASIS grammar files</a></li><li><a href="../../non-normative/interoperability-considerations.html">Processing interoperability considerations</a></li><li><a href="../../non-normative/revision-history.html">Revision history</a></li></ul></nav><main role="main" class="col-lg-9"><article role="article" aria-labelledby="ariaid-title1">
   <h1 class="title topictitle1" id="ariaid-title1">Processing key references</h1>
   
   
   <div class="body conbody"><p class="shortdesc">Key references can resolve as links, as text, or as both. Within a map, they also can
        be used to create or supplement information on a topic reference. This topic covers
        information that is common to all key processing, regardless of how the key is
        used.</p>
      <span class="undefined_element">
         <span class="undefined_element">Processing of undefined keys</span>
         <span class="undefined_element">If both <span class="undefined_element">keyref</span> and <span class="undefined_element">href</span> attributes are specified on
                an element, the <span class="undefined_element">href</span> value <span class="undefined_element">MUST</span>
                be used as a fallback address when the key name is undefined. If both
                    <span class="undefined_element">conkeyref</span> and <span class="undefined_element">conref</span> attributes are specified
                on an element, the <span class="undefined_element">conref</span> value <span class="undefined_element">MUST</span> be used as a fallback address when the key name is undefined.</span>
      </span>
      <span class="undefined_element">
         <span class="undefined_element">Determining effective attributes on the key-referencing element</span>
         <span class="undefined_element">The attributes that are common to the key-defining element and the key-referencing
element, other than the <span class="undefined_element">keys</span>,<span class="undefined_element">
               <span class="undefined_element">processing-role</span>,</span> and <span class="undefined_element">id</span> attributes, are combined as for
content references, including the special processing for the <span class="undefined_element">xml:lang</span>,
<span class="undefined_element">dir</span>, and <span class="undefined_element">translate</span> attributes.</span>
      </span>
      <span class="undefined_element">
         <span class="undefined_element">Keys and conditional processing</span>
         <span class="undefined_element">The effective key definitions for a key space might be affected by conditional
                processing (filtering). Processors <span class="undefined_element">SHOULD</span>
                perform conditional processing before determining the effective key definitions.
                However, processors might determine effective key definitions before filtering.
                Consequently, different processors might produce different effective bindings for
                the same map when there are key definitions that might be filtered out based on
                their filtering attributes.</span>
         <span class="undefined_element">In order to retain backwards compatibility with DITA 1.0 and 1.1, the
                specification does not mandate a processing order for different DITA features. This
                makes it technically possible to determine an effective key definition, resolve
                references to that key definition, and then filter out the definition. However, the
                preferred approach is to take conditional processing into account when resolving
                keys, so that key definitions which are excluded by processing are not used in
                resolving key references.</span>
      </span>
      <span class="undefined_element">
         <span class="undefined_element">Reusing a topic in multiple key scopes</span>
         <span class="undefined_element">If a topic that contains key references is reused in multiple key scopes within a
                given root map such that its references resolve differently in each use context,
                processors <span class="undefined_element">MUST</span> produce multiple copies of the
                source topic in resolved output for each distinct set of effective key definitions
                that are referenced by the topic. </span>
         <span class="undefined_element">In such cases, authors can use <span class="undefined_element">resourceid</span> within topic
                references to specify distinct anchor components for each instance of the topic.</span>
         <span class="undefined_element"> with the <span class="undefined_element">appid-role</span> attribute set to
                    <span class="undefined_element">deliverable-anchor</span> to specify different source URIs for each
                reference to a topic.</span>
      </span>
      <span class="undefined_element">
         <span class="undefined_element">Error conditions</span>
         <span class="undefined_element">If a referencing element contains a key reference with an undefined key, it is
                processed as if there were no key reference, and the value of the
                    <span class="undefined_element">href</span> attribute is used as the reference. If the
                    <span class="undefined_element">href</span> attribute is not specified, the element is not treated as
                a navigation link. If it is an error for the element to be empty, an implementation
                    <span class="undefined_element">MAY</span> give an error message; it also <span class="undefined_element">MAY</span> recover from this error condition by leaving
                the key reference element empty.</span>
      </span>
   </div>
   <nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../archSpec/base/key-based-addressing.html" title="DITA keys provide an alternative to direct addressing. The key reference mechanism provides a layer of indirection so that resources (for example, URIs, metadata, or variable text strings) can be defined at the DITA map level instead of locally in each topic.">Indirect key-based addressing</a></div></div></nav>
</article></main>
