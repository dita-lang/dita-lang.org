---
# Generated from DITA source
layout: base
title: 'Branch filtering: Implications of processing order'
description: 'The branch filtering mechanism can result in changes to the global key space for a root map. As a result, processors are required to evaluate branch filtering in order to construct the key space.'
index: '../../toc.html'
notices: '../../resources/oasis-notices.html'
commit: 'adaf2c7cf4d9c09d789de4e79b975464ce855129'
repository: 'oasis-tcs/dita'
---

<nav role="toc" class="col-lg-3"><ul><li><a href="../../introduction/dita-release-overview.html">Introduction</a></li><li><a href="../../archSpec/base/dita-terminology.html">DITA terminology, notation, and conventions</a></li><li><a href="../../archSpec/base/introduction-to-dita.html">Overview of DITA</a></li><li><a href="../../archSpec/base/accessibility-and-translation.html">Accessibility and translation</a></li><li><a href="../../archSpec/base/dita-map-processing.html">DITA map processing</a></li><li><a href="../../archSpec/base/ditaaddressing.html">DITA addressing</a></li><li><a href="../../archSpec/base/behaviors.html">DITA processing</a><ul class="nav nav-list"><li><a href="../../archSpec/base/navigation.html">Navigation</a></li><li><a href="../../archSpec/base/indexes.html">Indexes</a></li><li><a href="../../archSpec/base/conref.html">Content reference (conref)</a></li><li><a href="../../archSpec/base/condproc.html">Conditional processing</a></li><li><a href="../../archSpec/base/branch-filtering.html">Branch filtering</a><ul class="nav nav-list"><li><a href="../../archSpec/base/branch-filtering-overview.html">Overview of branch filtering</a></li><li><a href="../../archSpec/base/branch-filtering-interactions.html">How filtering rules interact</a></li><li><a href="../../archSpec/base/branch-filtering-single-set.html">Branch filtering: Single referenced DITAVAL document for a branch</a></li><li><a href="../../archSpec/base/branch-filtering-multiple-sets.html">Branch filtering: Multiple referenced DITAVAL documents for a branch</a></li><li><a href="../../archSpec/base/branch-filtering-resource-names.html">Branch filtering: Impact on resource and key names</a></li><li class="active"><a href="../../archSpec/base/branch-filtering-implications-of-processing-order.html">Branch filtering: Implications of processing order</a></li><li><a href="../../archSpec/base/examples-of-branch-filter.html">Examples of branch filtering</a></li></ul></li><li><a href="../../archSpec/base/sort-as-processing.html">Sorting</a></li><li><a href="../../archSpec/base/determining-effective-attribute-values.html">Determining effective attribute values</a></li></ul></li><li><a href="../../archSpec/base/configuration-specialization-and-constraints.html">Configuration and specialization </a></li><li><a href="../../langRef/langRef-base.html">Element reference</a></li><li><a href="../../conformance/conformance.html">Conformance</a></li><li><a href="../../acknowledgments/acknowledgments.html">Acknowledgments</a></li><li><a href="../../non-normative/aggregated-RFC-2119-statements.html">Aggregated RFC-2119 statements</a></li><li><a href="../../archSpec/base/coding-requirements.html">Coding practices for DITA grammar files</a></li><li><a href="../../non-normative/developing-constraint-and-expansion-modules.html">Constraint modules</a></li><li><a href="../../non-normative/expansion-modules.html">Expansion modules</a></li><li><a href="../../non-normative/elementsMerged.html">Element-by-element recommendations for translators</a></li><li><a href="../../non-normative/formatting-expectations.html">Formatting expectations</a></li><li><a href="../../non-normative/migrating-to-dita-2.0.html">Migrating to DITA 2.0</a></li><li><a href="../../non-normative/basedoctypes.html">OASIS grammar files</a></li><li><a href="../../non-normative/interoperability-considerations.html">Processing interoperability considerations</a></li><li><a href="../../non-normative/revision-history.html">Revision history</a></li></ul></nav><main role="main" class="col-lg-9"><article role="article" aria-labelledby="ariaid-title1">
   <h1 class="title topictitle1" id="ariaid-title1">Branch filtering: Implications of processing order</h1>
   
   
   <div class="body conbody"><p class="shortdesc">The branch filtering mechanism can result in changes to the global key space for a root
    map. As a result, processors are required to evaluate branch filtering in order to construct the
    key space.</p>
      <span class="undefined_element">The full effects of the branch filtering process <span class="undefined_element">MUST</span> be
      calculated by processors before they construct the effective map and key scope structure. This
      requirement comes from the fact that the branch filtering process can result in new or renamed
      keys, key scopes, or URIs that make up the key space.</span>
      <span class="undefined_element">Do we remember what "relaed attributes" are
      in the following note? Can we keep it simple and just say that keyref attribute is
      disallowed?</span>
      <span class="undefined_element">The <span class="undefined_element">keyref</span> attribute and related attributes are explicitly disallowed on
        <span class="undefined_element">ditavalref</span>. This prevents any confusion resulting from a
        <span class="undefined_element">keyref</span> that resolves to additional key- or resource-renaming
      metadata.</span>
      <span class="undefined_element">In general, the DITA specification refrains from mandating a processing order; thus publication
      results can vary slightly depending on the order in which processes are run. With branch
      filtering, processors are not required to apply filter conditions specified outside of the map
      and filter conditions specified with <span class="undefined_element">ditavalref</span> at the same time in a
      publishing process.</span>
      <span class="undefined_element">For example, a processor might use the following processing order:</span>
      <span class="undefined_element">
         <span class="undefined_element">Apply externally-specified filter conditions to maps</span>
         <span class="undefined_element">Apply filtering  based on <span class="undefined_element">ditavalref</span> elements</span>
      </span>
      <span class="undefined_element">Because externally-specified "exclude" conditions always take precedence over
      branch-specific conditions, content excluded based on external conditions will always be
      removed, regardless of the order in which processors evaluate conditions.</span>
      <span class="undefined_element">Processors should consider the following points when determining a processing order:</span>
      <span class="undefined_element">
         <span class="undefined_element">If links are generated based on the map hierarchy, those links should be created using the
        renamed keys and URIs that result from evaluating the <span class="undefined_element">ditavalref</span>
        filter conditions, to ensure that the links are consistent within the modified branches. For
        example, sequential links based on a map hierarchy should remain within the appropriate
        modified branch.</span>
         <span class="undefined_element">If URI-based content references are resolved in topics before the
          <span class="undefined_element">ditavalref</span> filtering conditions are evaluated, content that
        applies to multiple audiences can be brought in and (later in the process) selectively
        filtered by branch. <span class="undefined_element">For example, if a set of installation steps is
          pulled in with conref (from outside the branch), it might contain information that is
          later filtered by platform based on <span class="undefined_element">ditavalref</span>. This results in
          copies of the steps that are specific to each operating system. If conref is processed
          after the <span class="undefined_element">ditavalref</span>, content might be pulled in that has not
          been appropriately filtered for the new context.</span>
         </span>
         <span class="undefined_element">The same scenario applies to conref values that push content into the branch.<span class="undefined_element">
               <span class="undefined_element">Pushing content into a branch before resolving the <span class="undefined_element">ditavalref</span>
            conditions allows content for multiple conditions to be pushed and then filtered by
            branch based on the <span class="undefined_element">ditavalref</span> conditions.</span>
               <span class="undefined_element">If the branch using <span class="undefined_element">ditavalref</span> pushes content elsewhere,
            resolving <span class="undefined_element">ditavalref</span> first could result in multiple copies of
            the content to be pushed (one for each branch), resulting in multiple potentially
            conflicting copies pushed to the new destination.</span>
            </span>
         </span>
      </span>
   </div>
   <nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../archSpec/base/branch-filtering.html" title="The branch filtering mechanism enables map authors to set filtering conditions for specific branches of a map. This makes it possible for multiple conditional-processing profiles to be applied within a single publication.">Branch filtering</a></div></div></nav>
</article></main>
